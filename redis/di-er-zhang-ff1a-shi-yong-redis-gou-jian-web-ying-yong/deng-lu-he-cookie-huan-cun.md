### 登录和cookie缓存

每当我们登录互联网服务的时候，这些服务都会使用cookie来记录我们的身份。cookie由少量数据组成，网站会要求我们的浏览器存储这些数据，并在每次服务器请求发送时将这些数据传回给服务器。对于用来登录的cookie，有两种常见的方式可以将登录信息存储在cookie里面：

* 签名【signed】cookie
* 令牌【token】cookie

签名cookie通常会存储用户名，可能还有用户ID，用户最后一次登录成功的时间，以及网站觉得有用的其他任何信息。除了用户的相关信息之外，签名cookie还包含了一个签名，服务器可以使用这个签名来验证浏览器发送的消息是否未经改动（比如将cookie中的登录用户名改成另一个用户）。

令牌cookie会在cookie里面存储一串随机字节作为令牌，服务器可以根据令牌在数据库中查询令牌的拥有者。随着时间的推移，旧令牌会被新令牌去掉。

| cookie类型 | 优点 | 缺点 |
| :--- | :--- | :--- |
| 签名cookie | 验证cookie所需的一切信息都存储在cookie里面，cookie可以包含额外的信息，并且对这些信息进行签名也很容易。 | 正确的处理签名很难，很容易忘记对数据进行签名，或者忘记验证数据的签名，从而造成安全漏洞。 |
| 令牌cookie | 添加信息非常容易，cookie的体积非常小，因此移动终端和速度较慢的客户端可以更快地发送请求。 | 需要在服务中存储更多信息，如果使用的是关系数据库，那么载入和存储的cookie的代价可能会很高。 |



